local LibraryName = "Notification Library"
local NotificationLibrary = {}

local TweenService = game:GetService("TweenService")
local CoreGui = cloneref(game:GetService("CoreGui"))

local library
local templateFolder
local canvas


local TweenFast = TweenInfo.new(0.25, Enum.EasingStyle.Quint, Enum.EasingDirection.Out)
local TweenSmooth = TweenInfo.new(0.35, Enum.EasingStyle.Quint, Enum.EasingDirection.Out)
local TweenFade = TweenInfo.new(0.2, Enum.EasingStyle.Linear, Enum.EasingDirection.Out)

function NotificationLibrary:Load()
    library = game:GetObjects("rbxassetid://15133757123")[1]
    templateFolder = library.Templates
    canvas = library.list

    library.Name = LibraryName
    library.Parent = CoreGui
end

local function getLibrary()
    local existing = CoreGui:FindFirstChild(LibraryName)
    if not existing then
        NotificationLibrary:Load()
    else
        library = existing
        templateFolder = library.Templates
        canvas = library.list
    end
end

function NotificationLibrary:SendNotification(Mode, Text, Duration)
    getLibrary()

    local template = templateFolder:FindFirstChild(Mode)
    if not template then
        warn("Invalid theme applied")
        return
    end

    task.spawn(function()
        local success, err = pcall(function()
            local Notification = template:Clone()
            local filler = Notification:WaitForChild("Filler")
            local bar = Notification:WaitForChild("bar")

            Notification.Header.Text = Text
            Notification.Parent = canvas
            Notification.Visible = true

          
            Notification.BackgroundTransparency = 1
            Notification.Size = UDim2.new(0, 0, 0.085, 0)
            filler.Size = UDim2.new(1, 0, 1, 0)
            bar.Size = UDim2.new(0, 0, 0.05, 0)
            e)
            TweenService:Create(Notification, TweenSmooth, {
                BackgroundTransparency = 0,
                Size = UDim2.new(1, 0, 0.085, 0)
            }):Play()

            task.wait(0.12)

            
            TweenService:Create(filler, TweenSmooth, {
                Size = UDim2.new(0.015, 0, 1, 0)
            }):Play()

            
            TweenService:Create(bar, TweenInfo.new(Duration, Enum.EasingStyle.Linear), {
                Size = UDim2.new(1, 0, 0.05, 0)
            }):Play()

            task.wait(Duration)

            
            TweenService:Create(filler, TweenFast, {
                Size = UDim2.new(1, 0, 1, 0)
            }):Play()

            task.wait(0.18)

            TweenService:Create(Notification, TweenSmooth, {
                BackgroundTransparency = 1,
                Size = UDim2.new(0, 0, 0.085, 0)
            }):Play()

            task.wait(0.3)
            Notification:Destroy()
        end)

        if not success then
            warn("Notification error:")
            warn(err)
        end
    end)
end

return NotificationLibrary
